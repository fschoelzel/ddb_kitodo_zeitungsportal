/**
 * (c) Kitodo. Key to digital objects e.V. <contact@kitodo.org>
 *
 * This file is part of the Kitodo and TYPO3 projects.
 *
 * @license GNU General Public License version 3 or later.
 * For the full copyright and license information, please read the
 * LICENSE.txt file that was distributed with this source code.
 */
dlfViewerOLStyles.textlineStyle=function(){return new ol.style.Style({stroke:new ol.style.Stroke({color:"rgba(0,59,80,1)",width:1})})};dlfViewerOLStyles.wordStyle=function(){return new ol.style.Style({stroke:new ol.style.Stroke({color:"rgba(0,59,80,0.8)",width:1}),fill:new ol.style.Fill({color:"rgba(0,59,80,0.25)"})})};
/**
 * (c) Kitodo. Key to digital objects e.V. <contact@kitodo.org>
 *
 * This file is part of the Kitodo and TYPO3 projects.
 *
 * @license GNU General Public License version 3 or later.
 * For the full copyright and license information, please read the
 * LICENSE.txt file that was distributed with this source code.
 */
if(typeof ddbKitodoZeitungsportalFullTextControl==="undefined"){class e extends dlfViewerFullTextControl{constructor(e,t,i){super(e,t,i);this.positions_;this.element;this.lastWidth}get positions(){if(this.positions_===undefined){this.positions_={}}return this.positions_}onResize(){if(this.element!=undefined&&this.element.css("width")!=this.lastWidth){this.lastWidth=this.element.css("width");this.calculatePositions()}}calculatePositions(){this.positions.length=0;let e=$("#tx-dlf-fulltextselection").children("span.textline");let t=$("#"+e[0].id).position().top;for(let i of e){let e=$("#"+i.id).position().top;this.positions[i.id]=e-t}}addHighlightEffect(e,t){if(e){var i=$("#"+e.getId());if(i.length>0&&!i.hasClass("highlight")){i.addClass("highlight");this.onResize();setTimeout(this.scrollToText,1e3,i,this.fullTextScrollElement,this.positions);t.addFeature(e)}}}scrollToText(e,t,i){if(e.hasClass("highlight")){$(t).animate({scrollTop:i[e[0].id]},500)}}activate(){super.activate();if(this.element===undefined){this.element=$("#tx-dlf-fulltextselection")}}showFulltext(e){super.showFulltext(e);if(e!==undefined){this.calculatePositions()}}}dlfViewerFullTextControl=e}
/**
 * (c) Kitodo. Key to digital objects e.V. <contact@kitodo.org>
 *
 * This file is part of the Kitodo and TYPO3 projects.
 *
 * @license GNU General Public License version 3 or later.
 * For the full copyright and license information, please read the
 * LICENSE.txt file that was distributed with this source code.
 */
function nextResultPage(){var e=$("#tx-dlf-search-in-document-form input[id='tx-dlf-search-in-document-start']").val();var t=parseInt(e)+20;$("#tx-dlf-search-in-document-form input[id='tx-dlf-search-in-document-start']").val(t);$("#tx-dlf-search-in-document-form").submit()}function previousResultPage(){var e=$("#tx-dlf-search-in-document-form input[id='tx-dlf-search-in-document-start']").val();var t=parseInt(e)>20?parseInt(e)-20:0;$("#tx-dlf-search-in-document-form input[id='tx-dlf-search-in-document-start']").val(t);$("#tx-dlf-search-in-document-form").submit()}function resetStart(){$("#tx-dlf-search-in-document-form input[id='tx-dlf-search-in-document-start']").val(0)}function addHighlightEffect(e){if(e.length>0){e.forEach((function(e){var t=$("#"+e);if(t.length>0&&!t.hasClass("highlight")){t.addClass("highlight")}}))}}function getBaseUrl(e){var t=$("form#tx-dlf-search-in-document-form").attr("action");if(t===undefined||t.split("?")[0].indexOf(e)===-1){t=$(location).attr("href")}return t}function getCurrentQueryParams(e){if(e.indexOf("?")>0){return e.slice(e.indexOf("?")+1).split("&")}return[]}function getAllQueryParams(e,t){var i=getCurrentQueryParams(e);var n;for(var r=0;r<i.length;r++){n=i[r].split("=");if(t.indexOf(decodeURIComponent(n[0]))===-1){t.push(decodeURIComponent(n[0]));t[decodeURIComponent(n[0])]=n[1]}}return t}function isUrlConfiguredAsSlug(e){var t=getBaseUrl(e["uid"]).split("?")[0];return t.indexOf(e["uid"])>-1}function getNeededQueryParams(e){var t=$("input[id='tx-dlf-search-in-document-id']").attr("name");var i=$("input[id='tx-dlf-search-in-document-highlight-word']").attr("name");var n=$("input[id='tx-dlf-search-in-document-page']").attr("name");var r=[];if(i){r.push(i);r[i]=encodeURIComponent($("input[id='tx-dlf-search-in-document-query']").val())}if(n){r.push(n);r[n]=e["page"]}return r}function getHighlights(e){var t="";for(var i=0;i<e.length;i++){if(t===""){t+=e[i]}else{if(t.indexOf(e[i])===-1){t+=";"+e[i]}}}return t}function getLink(e){var t=getBaseUrl(e["uid"]);var i=getNeededQueryParams(e);if(t.indexOf("?")>0){i=getAllQueryParams(t,i);t=t.split("?")[0]}var n=t+"?";for(var r=0;r<i.length;r++){n+=i[r]+"="+i[i[r]]+"&"}n=n.slice(0,-1);return n}function getNavigationButtons(e,t){var i="";if(e>0){i+='<input type="button" id="tx-dlf-search-in-document-button-previous" class="button-previous" onclick="previousResultPage();" value="'+$("#tx-dlf-search-in-document-label-previous").text()+'" />'}if(t>e+20){i+='<input type="button" id="tx-dlf-search-in-document-button-next" class="button-next" onclick="nextResultPage();" value="'+$("#tx-dlf-search-in-document-label-next").text()+'" />'}return i}function search(){resetStart();$("#tx-dlf-search-in-document-loading").show();$("#tx-dlf-search-in-document-clearing").hide();$("#tx-dlf-search-in-document-button-next").hide();$("#tx-dlf-search-in-document-button-previous").hide();var e="/";if(typeof viewerUrl!=="undefined"){e=viewerUrl}else if($("#localJsVariables").attr("viewer-url")){e=$("#localJsVariables").attr("viewer-url")}$.post(e,{eID:"tx_dlf_search_in_document",q:$("input[id='tx-dlf-search-in-document-query']").val(),uid:$("input[id='tx-dlf-search-in-document-id']").val(),start:$("input[id='tx-dlf-search-in-document-start']").val(),encrypted:$("input[id='tx-dlf-search-in-document-encrypted']").val()},(function(e){var t=[];var i='<div class="results-active-indicator"></div><ul>';var n=$("input[id='tx-dlf-search-in-document-start']").val();if(e["numFound"]>0){e["documents"].forEach((function(e,i){if(n<0){n=i}if(e["snippet"].length>0){t[e["page"]]='<span class="structure">'+$("#tx-dlf-search-in-document-label-page").text()+" "+e["page"]+"</span><br />"+'<span class="textsnippet">'+'<a href="'+getLink(e)+'">'+e["snippet"]+"</a>"+"</span>"}}));t.sort((function(e,t){return e-t}));t.forEach((function(e,t){i+="<li>"+e+"</li>"}));addImageHighlight(e)}else{i+='<li class="noresult">'+$("#tx-dlf-search-in-document-label-noresult").text()+"</li>"}i+="</ul>";i+=getNavigationButtons(n,e["numFound"]);$("#tx-dlf-search-in-document-results").html(i)}),"json").done((function(e){$("#tx-dfgviewer-sru-results-loading").hide();$("#tx-dfgviewer-sru-results-clearing").show()}))}function getCurrentPage(){var e=1;var t=getBaseUrl(" ");var i=getCurrentQueryParams(t);var n=false;for(var r=0;r<i.length;r++){var l=i[r].split("=");if(decodeURIComponent(l[0])===$("input[id='tx-dlf-search-in-document-page']").attr("name")){e=parseInt(l[1],10);n=true}}if(!n){var a=t.split("/");e=parseInt(a.pop(),10)}return e}function addImageHighlight(e){var t=getCurrentPage();if(typeof tx_dlf_viewer!=="undefined"&&tx_dlf_viewer.map!=null){var i=[];e["documents"].forEach((function(e,n){if(t<=e["page"]&&e["page"]<t+tx_dlf_viewer.countPages()){if(e["highlight"].length>0){i.push(getHighlights(e["highlight"]))}addHighlightEffect(e["highlight"])}}));tx_dlf_viewer.displayHighlightWord(encodeURIComponent(i.join(";")))}else{setTimeout(addImageHighlight,500,e)}}function clearSearch(){$("#tx-dlf-search-in-document-results ul").remove();$(".results-active-indicator").remove();$("#tx-dlf-search-in-document-query").val("")}function triggerSearchAfterHitLoad(){var e=getCurrentQueryParams(getBaseUrl(" "));var t=$("input[id='tx-dlf-search-in-document-highlight-word']").attr("name");for(var i=0;i<e.length;i++){var n=e[i].split("=");if(t&&decodeURIComponent(n[0]).indexOf(t)!==-1){$("input[id='tx-dlf-search-in-document-query']").val(decodeURIComponent(n[1]));search();break}else if(decodeURIComponent(n[0]).indexOf("query")!=-1){$("input[id='tx-dlf-search-in-document-query']").val(decodeURIComponent(n[1]));search();break}}}$(document).ready((function(){if(document.getElementById("tx-dlf-search-in-document-query")){document.getElementById("tx-dlf-search-in-document-query").addEventListener("keydown",(function(e){if(e.key==="Enter"){e.preventDefault();search()}}));triggerSearchAfterHitLoad()}}));
/**
 * (c) Kitodo. Key to digital objects e.V. <contact@kitodo.org>
 *
 * This file is part of the Kitodo and TYPO3 projects.
 *
 * @license GNU General Public License version 3 or later.
 * For the full copyright and license information, please read the
 * LICENSE.txt file that was distributed with this source code.
 */
if(typeof ddbKitodoZeitungsportalViewer==="undefined"){class e extends dlfViewer{createControl(e,t){if(e==="OverviewMap"){return this.createOverviewMap(t)}else{return super.createControl(e,t)}}createOverviewMap(e){var t=122-2*3;var i=ol.extent.createEmpty();for(let e=0;e<this.images.length;e++){ol.extent.extend(i,[0,-this.images[e].height,this.images[e].width,0])}var n=ol.extent.getWidth(i);var r=ol.extent.getHeight(i);var l=n/t;var a=new ol.control.OverviewMap({tipLabel:this.dic["overview-map"],label:"+",collapseLabel:"â€“",collapsed:false,layers:e.map(dlfUtils.cloneOlLayer),view:new ol.View({center:ol.extent.getCenter(i),extent:i,projection:new ol.proj.Projection({code:"kitodo-image",units:"pixels",extent:i}),showFullExtent:false,minResolution:l,maxResolution:l,resolution:l})});var o=this.dic;var s=a.element.querySelector("button");if(s!==null){var d=function(){if(a.getCollapsed()){s.title=o["overview-map.show"]}else{s.title=o["overview-map.hide"]}};s.addEventListener("click",d);d()}$(window).on("map-loadend",(function(){var e=document.querySelector(".ol-overviewmap-map");if(e!==null){var i=Math.ceil(r/n*t);e.style.cssText+=";width: "+t+"px !important; height: "+i+"px !important;";a.getOverviewMap().updateSize()}}));return a}}dlfViewer=e}